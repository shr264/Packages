{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Gaussian DAGs with known partial ordering\"\nauthor: \"Syed Rahman\"\nheader-includes:\n  - \\newcommand{\\abs}[1]{\\left|#1\\right|}\n  - \\DeclareMathOperator*{\\trace}{trace}\n  - \\DeclareMathOperator*{\\sign}{sign}\n  - \\usepackage{tkz-graph}\n  - \\usetikzlibrary{arrows,positioning,automata}\ndate: \"4/17/2017\"\noutput:\n  pdf_document: \n    keep_tex: true\n---\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\nknitr::opts_chunk$set(tidy.opts=list(width.cutoff=60),tidy=TRUE)\nlibrary(knitr)\nlibrary(MASS)\nlibrary(ggplot2)\nlibrary(igraph)\nlibrary(Matrix)\nlibrary(pcalg)\nlibrary(Rgraphviz)\nlibrary(partial)\nlibrary(ggm)\n#setwd(\"/Users/syedrahman/Documents/Spring2017/partialcscs/code\")\nsource(\"partialwithboth4.r\")\nsource(\"blkszcmpr4.R\")\nsource(\"blkszcmpr5.R\")\nsource(\"blkszcmpr6.R\")\nset.seed(12345)\n```\n\n```{r}\nedge = matrix(0,nrow = 17, ncol = 2)\nedge[1,] = c(\"PLCG\",\"PIP2\")\nedge[2,] = c(\"PLCG\",\"PKC\")\nedge[3,] = c(\"PLCG\",\"PIP3\")\nedge[4,] = c(\"PIP3\",\"PIP2\")\nedge[5,] = c(\"PKA\",\"PAKTS473\")\nedge[6,] = c(\"PKC\",\"PRAF\")\nedge[7,] = c(\"PKC\",\"PMEK\")\nedge[8,] = c(\"PKC\",\"PJNK\")\nedge[9,] = c(\"PKC\",\"P38\")\nedge[10,] = c(\"PKA\",\"PRAF\")\nedge[11,] = c(\"PKA\",\"PMEK\")\nedge[12,] = c(\"PKA\",\"P44.42\")\nedge[13,] = c(\"PKA\",\"PJNK\")\nedge[14,] = c(\"PKA\",\"P38\")\nedge[15,] = c(\"PRAF\",\"PMEK\")\nedge[16,] = c(\"PMEK\",\"P44.42\")\nedge[17,] = c(\"P44.42\",\"PAKTS473\")\ngraph = graph_from_edgelist(edge)\neltrue = apply(get.edgelist(graph), 1, paste, collapse=\"-\")\nadj = as_adjacency_matrix(graph,sparse=FALSE)\n```\n\n```{r, echo = FALSE}\nadj = adj[c(1,4,2,3,5,6,7,8,9,10,11),c(1,4,2,3,5,6,7,8,9,10,11)]\n#diag(adj) = 1\ngraph = graph_from_adjacency_matrix(adj)\ncoords = matrix(0,ncol = 2, nrow = 11)\nnum2 = 0\nfor (i in 1:5){\n        coords[i,2] = ifelse(i%%2==0,4,5)\n        coords[i,1] = 2*num2\n        num2 = num2 + 1\n}\nnum2 = 0\nfor (i in 6:11){\n        coords[i,2] = ifelse(i%%2==0,1,2)\n        coords[i,1] = 2*num2\n        num2 = num2 + 1\n    }\nplot(graph, layout = coords, vertex.size=15, vertex.label.dist = .1, edge.arrow.size = 0.5)\n```\n\n\n```{r, echo = FALSE}\nreps = 20\nccdrfpr = rep(0,reps)\nccdrtpr = rep(0,reps)\npartialfpr = rep(0,reps)\npartialtpr = rep(0,reps)\nccdrmcc = rep(0,reps)\npartialmcc = rep(0,reps)\n```\n\n```{r}\ndata = read.csv('SachsData.csv')\ndata = data[,2:12]\ndata = data[,c(3,5,4,9,8,7,1,2,11,10,6)]\nX = scale(data, center = TRUE, scale = TRUE)\norder3 = sample(1:11)\nX = X[,order3]\n```\n\n## CCDr\n\n```{r, lambda ,echo=TRUE,results='hide',fig.keep='all'}\nlambda = seq(0.1,4, length= reps)\n#lambda = 0.35\n```\n\n```{r, ccdr, echo=TRUE,results='hide',fig.keep='all'}\nccdrtab = NULL\nfor(i in 1:length(lambda)){\n  #i = 1\n  estadj = ccdr_cust(X = X,lambda = lambda[i],verbose = FALSE)!=0\n  diag(estadj) = 0\n  ccdrfpr[i] = fpr(adj,estadj)\n  ccdrtpr[i] = tpr(adj,estadj)\n  ccdrmcc[i] = mcc(adj,estadj)\n  rownames(estadj) = colnames(data)\n  colnames(estadj) = colnames(data)\n  #diag(estadj) = 0\n  graphccdr = graph_from_adjacency_matrix(estadj)\n  print(plot(graphccdr, layout = coords, vertex.size=15, vertex.label.dist = .1, edge.arrow.size = 0.5))\n}\n```\n\n```{r}\nccdrfpr\nccdrtpr\nccdrmcc\n```\n\n## Partial CCDr\n\n```{r, partial, echo=TRUE,results='hide',fig.keep='all'}\nX = scale(data, center = TRUE, scale = TRUE)\norder1 = sample(1:5)\norder2 = sample(6:11)\norder3 = c(order1,order2)\nX = X[,order3]\npartialtab = NULL\nfor(i in 1:length(lambda)){\n  estadj = partial_cust2(X=X,lambda = lambda[i],m = 25, verbose = FALSE)!=0\n  diag(estadj) = 0\n  partialfpr[i] = fpr(adj,estadj)\n  partialtpr[i] = tpr(adj,estadj)\n  partialmcc[i] = mcc(adj,estadj)\n  rownames(estadj) = colnames(data)\n  colnames(estadj) = colnames(data)\n  #diag(estadj) = 0\n  graphccdr = graph_from_adjacency_matrix(estadj)\n  print(plot(graphccdr, layout = coords, vertex.size=15, vertex.label.dist = .1, edge.arrow.size = 0.5))\n}\n```\n\n```{r}\npartialfpr\npartialtpr\npartialmcc\n```\n\n",
    "created" : 1505934753010.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "525327732",
    "id" : "3CC5D3F1",
    "lastKnownWriteTime" : 1505934894,
    "last_content_update" : 1505934929429,
    "path" : "~/Documents/Spring2017/partialcscs/SachsData/gaussiandagsSachs6.Rmd",
    "project_path" : null,
    "properties" : {
        "last_setup_crc32" : "DE627F3C5b22efa8"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}